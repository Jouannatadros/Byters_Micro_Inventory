<html>
    <head>
        <title>Products</title>
        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>    
        <link rel="stylesheet" href="css/style.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    </head>
    <body>

        <div class="container">
            <br>
            <br>
            <br>
            <div class="input-group" style="background-color: #fff ;border-radius:10px;">
                <input type="search" id="search" class="form-control rounded" placeholder="Search.." aria-label="Search" aria-describedby="search-addon" />
                <button type="button" id="searchbtn" class="btn btn-outline-primary">search</button>
            </div>
            <div class="products" id="products_container">
                
            </div>
        </div>
          <script type="text/JavaScript">
            $(document).ready(function() {
                $("#searchbtn").click();
            });
            
                $("#searchbtn").click(function(){
                    var search =  $("#search").val();
                    $('#products_container .product').remove();
                    $('#products_container span').remove();

                    prodCount = 0; 
                    $.ajax({
                      contentType: "application/json",
                      type: "GET",
                      url: "http://localhost:3000/products",
                      success: function (data) {
                        $.each(data, function (i, item) {  
                          if(item.productName.toLowerCase() == search.toLowerCase()|| item.description.toLowerCase() == search.toLowerCase()   || search == ''){
                            if(item.quantitiy=='0'){
                              item.description+='(OUT OF STOCK)'
                             prodCount += 1;
                            var rows = 
                                            '<div class="product">'
                                                +'<img src="'+item.image+'" alt="">'
                                                +'<div class="prod_det">'
                                                    +'<span class="prod_name">'+item.productName+'</span>'
                                                    +'<span class="prod_dets">'+item.description+'</span>'
                                                    +'<span class="prod_price"> $'+item.price+'</span>'    
                                                    
                                                +'</div>'
                                            +'</div>';
                                    $('#products_container').append(rows);   

                            }
                            else{
                            prodCount += 1;
                             rows = 
                                            '<div class="product">'
                                                +'<img src="'+item.image+'" alt="">'
                                                +'<div class="prod_det">'
                                                    +'<span class="prod_name">'+item.productName+'</span>'
                                                    +'<span class="prod_dets">'+item.description+'</span>'
                                                    +'<span class="prod_price"> $'+item.price+'</span>'    
                                                    +'<a href="order.html?prodname='+item.productName+'&prodId='+item.id+'&prodprice='+item.price+'&prodImg='+item.image+'" class="buy">ðŸ›’ Buy Now</a>'
                                                +'</div>'
                                            +'</div>';
                                    $('#products_container').append(rows); }
                          }
                        });  
                        if(prodCount == 0){

                          var rows = "<span style='color:red;text-align:center;font-weight:500;font-size:20px;letter-spacing: 7px;'>No Product Found..</span>";  
                          $('#products_container').append(rows); 
                        }
                      },error: function(){alert("ERROR!");}
                    });  
                })  
          
        </script>
    </body>
</html>

